{% extends "events_base.html" %}
{% load static %}
{% block content %}
<div class="container">

    <div class="route-navigator" >
            <ol class="breadcrumb">
                <li><a href="{% url 'events_home' %}">Inicio</a></li>
                <li><a href="{% url 'event_list' %}">Eventos</a></li>
                <li><a href="{% url 'event_detail' pk=event.pk %}">{{event.name}}</a></li>
                <li><a href="{% url 'sponsoring_list' event_pk=event.pk%}">Patrocinios</a></li>
                <li class="active"><a href="{% url 'sponsoring_detail' pk=sponsoring.pk%}">
                        {{sponsoring.sponsor.organization_name}} ({{sponsoring.sponsorcategory.name}})
                </a></li>
            </ol>
    </div>
    <h1>Patrocinio {{sponsoring.sponsorcategory.name}} ({{sponsoring.state}})</h1>
    <div class="row sponsoring-detail">
        <div class="col-md-6">
            <h3>Datos Evento</h3>
            {% include "events/event_describe_table.html" with event=event %}
        </div>
        <div class="col-md-6">
            <h3>Datos Patrocinador </h3>
            {% include "sponsors/sponsor_describe_table.html" with sponsor=sponsoring.sponsor %}
        </div>
        
    </div>

    <div class="row">
        <div class="col-md-12 text-right">
            Acciones sobre el patrocinio
        </div>
    </div>

    <div class="row">
        {% if sponsoring.invoice %}
        <div class="col-md-8">
            Fatura Monto: {{sponsoring.invoice.amount}}<br/>
            {% if sponsoring.invoice.extension == ".pdf" %}
            <!--button id="upload-button">Select PDF</button> 
            <input type="file" id="file-to-upload" accept="application/pdf" />
            
            <div id="pdf-main-container">
                <div id="pdf-loader">Loading document ...</div>
                <div id="pdf-contents">
                    <div id="pdf-meta">
                        <div id="pdf-buttons">
                            <button id="pdf-prev">Previous</button>
                            <button id="pdf-next">Next</button>
                        </div>
                        <div id="page-count-container">Page <div id="pdf-current-page"></div> of <div id="pdf-total-pages"></div></div>
                    </div>
                    <canvas id="pdf-canvas" width="400"></canvas>
                    <div id="page-loader">Loading page ...</div>
                </div>
            </div-->

            <div id="invoice-pdf-div" class="col-md-12" invoice-url={{sponsoring.invoice.document.url}} worker-url="{% static 'js/pdf.worker.js' %}">
                {{sponsoring.invoice.extension}}   
                <canvas id="pdf-canvas"></canvas> 
            </div>
            {% endif %}
            
        </div>
        <div class="col-md-4">
            Afectaciones:
        </div>
        {% else %}
        <div class="col-md-12">
            <div class="alert alert-info" role="alert">
                Patrocinio sin datos de facturaci√≥n
            </div>
            
            <p class="text-right">
            {% if sponsoring.state == "no facturado" and perms.events.add_invoice %}
                <a class="btn btn-primary"
                onclick="return open_modal('{% url 'sponsoring_invoice_create' sponsoring.pk %}')"
                    >Facturar</a>
            {% endif %}
            </p>
        </div>
        {% endif %}
        
    </div>

</div>
<div id="popup" class="modal fade" role="dialog">
</div>       
{% endblock %}

{% block extra_js %}
    <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
    
    <script src="{% static 'js/modal_form.js' %}"></script>
    <script src="{% static 'js/load_pdf_files.js' %}"></script>
{% endblock %}